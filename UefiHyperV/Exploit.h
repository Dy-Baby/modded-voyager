#pragma once

#define P2ALIGNDOWN(x, align) ((x) & -(align))
#define P2ALIGNUP(x, align) (-(-(x) & -(align)))
#define NT_HEADER(x) ((EFI_IMAGE_NT_HEADERS64*)(((UINT64)(x)) + ((EFI_IMAGE_DOS_HEADER*)(x))->e_lfanew))

extern VOID* ExpLoad;

UINT32 GetExpSize(VOID);
VOID* GetExpEntry(VOID* ModuleBase);
VOID* CreateExpSection(VOID* ImageBase, CHAR8* SectionName, UINT32 VirtualSize, UINT32 Characteristics);